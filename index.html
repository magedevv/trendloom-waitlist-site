<!doctype html>
<html lang="en">
<head>
  <!-- =========================
       META ‚Ä¢ SEO ‚Ä¢ SOCIAL
  ========================== -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>TrendLoom ‚Äî Create. Post. Be Viral.</title>
  <meta name="description" content="TrendLoom ‚Äî The studio that turns your ideas into scroll-stopping content. Join the private beta." />
  <meta name="theme-color" content="#0b0f14" />

  <!-- Favicons (files must sit next to this HTML) -->
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32.png">
  <link rel="icon" type="image/png" sizes="192x192" href="favicon-192.png">
  <link rel="apple-touch-icon" href="favicon-192.png">

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="TrendLoom ‚Äî Create. Post. Be Viral.">
  <meta property="og:description" content="The studio that turns your ideas into scroll-stopping content. Join the private beta.">
  <meta property="og:image" content="logo.png">
  <meta name="twitter:card" content="summary_large_image">

  <!-- JSON-LD: Organization -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Organization",
    "name":"TrendLoom",
    "url":"https://trendloom.app",
    "logo":"https://trendloom.app/logo.png"
  }
  </script>

  <!-- Inter font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

  <!-- Supabase via CDN (public) -->
  <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js"></script>

  <style>
    /* =========================
       DESIGN TOKENS
    ========================== */
    :root{
      --bg:#0b0f14;
      --fg:#eaf2ff;
      --muted:#9fb1c7;
      --brand:#38bdf8;           /* neon cyan */
      --brand-2:#60a5fa;         /* soft blue */
      --accent:#facc15;          /* golden spark */
      --ring:#1b3a55;
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --radius:16px;
      --glass:rgba(255,255,255,.06);
      --outline-focus: 2px solid rgba(56,189,248,.9);
    }

    /* Reset + Layout base */
    *{box-sizing:border-box}
    html,body{height:100%}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background: var(--bg);
      color: var(--fg);
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      overflow:hidden; /* ‚ùó desktop: no scroll */
    }
    @media (max-width: 768px){
      body{overflow:auto;} /* allow minimal scroll on small screens if needed */
    }

    /* Root grid */
    .page{
      min-height:100svh;
      display:grid;
      grid-template-rows:auto 1fr auto;
      position:relative;
      isolation:isolate;
    }

    /* =========================
       BACKDROP: gradient + grain
    ========================== */
    .gradient{
      position:fixed; inset:-20% -20% -20% -20%; pointer-events:none; z-index:-4;
      background:
        radial-gradient(1200px 900px at 15% 10%, rgba(56,189,248,.18), transparent 60%),
        radial-gradient(1000px 800px at 85% 30%, rgba(96,165,250,.16), transparent 60%),
        radial-gradient(900px 700px at 50% 85%, rgba(250,204,21,.10), transparent 65%),
        linear-gradient(180deg, #071018, #0b0f14 60%, #06090d);
      filter: saturate(110%);
    }
    .grain{
      position:fixed; inset:0; z-index:-3; pointer-events:none;
      opacity:.08; mix-blend-mode: soft-light;
      background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='120'><filter id='n'><feTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/><feColorMatrix type='saturate' values='0'/><feComponentTransfer><feFuncA type='table' tableValues='0 0 .02 .06 .1'/></feComponentTransfer></filter><rect width='100%' height='100%' filter='url(%23n)'/></svg>");
      background-size: 220px 220px;
    }

    /* =========================
       SVG NEON RINGS (decor)
    ========================== */
    .rings{
      position:fixed; inset:0; pointer-events:none; z-index:-2;
    }
    .rings svg{
      width:min(120vmin, 1400px); height:auto;
      position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
      opacity:.65; filter: drop-shadow(0 0 30px rgba(56,189,248,.25));
    }

    /* =========================
       CANVAS PARTICLES
    ========================== */
    #fx{
      position:fixed; inset:0; z-index:-1; pointer-events:none;
    }

    /* =========================
       HEADER
    ========================== */
    header{
      display:flex; align-items:center; justify-content:space-between;
      padding:clamp(16px, 2vw, 28px) clamp(16px, 3vw, 40px);
    }
    .brand{
      display:flex; align-items:center; gap:12px;
    }
    .brand img{
      height:32px; width:auto; display:block;
      filter: drop-shadow(0 0 16px rgba(56,189,248,.35));
    }
    .brand-name{
      font-weight:800; letter-spacing:.2px; color:#e6f4ff;
      text-shadow:0 2px 20px rgba(96,165,250,.18);
    }

    /* =========================
       HERO (centered)
    ========================== */
    .hero{
      display:grid; place-items:center; padding: clamp(10px, 3vw, 20px);
    }
    .card{
      max-width:min(100%, 1080px);
      display:grid; gap:20px;
      text-align:left;
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid rgba(148,163,184,.18);
      border-radius: clamp(14px, 2vmin, 22px);
      padding: clamp(24px, 4vw, 44px);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }
    .badge{
      display:inline-flex; align-items:center; gap:10px;
      border:1px solid rgba(148,163,184,.25);
      background: rgba(255,255,255,.05);
      padding:6px 12px; border-radius:999px; font-size:14px; color:#e8f0ff;
    }
    .dot{ width:8px; height:8px; border-radius:50%; background:var(--accent); box-shadow:0 0 0 0 rgba(250,204,21,.6); animation:pulse 2s infinite }
    @keyframes pulse { to { box-shadow: 0 0 0 14px rgba(250,204,21,0);} }

    h1{
      margin:0;
      font-size: clamp(32px, 5.8vw, 72px);
      line-height:1.04;
      letter-spacing:-.02em;
      text-wrap:balance;
    }
    .shimmer{
      position:relative; display:inline-block;
      background: linear-gradient(90deg, #fff 0%, #dbeafe 30%, #ffffff 60%, #dbeafe 100%);
      -webkit-background-clip:text; background-clip:text; color:transparent;
    }
    .shimmer::after{
      content:""; position:absolute; inset:0;
      background: linear-gradient(120deg, transparent 0%, rgba(255,255,255,.6) 25%, transparent 50%);
      transform: translateX(-120%);
      animation: shine 2.8s linear infinite;
      mix-blend-mode: screen;
    }
    @keyframes shine { to { transform: translateX(120%);} }

    .lead{
      color: var(--muted);
      font-size: clamp(16px, 1.6vw, 20px);
      max-width: 44ch;
    }

    form.waitlist{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
      max-width: 560px; margin-top: 6px;
    }
    .input{
      appearance:none; -webkit-appearance:none;
      flex:1 1 320px; min-width:260px;
      font-size:16px; color:#e9f1ff;
      padding:14px 16px; border-radius:12px;
      border:1px solid rgba(148,163,184,.22);
      background: rgba(255,255,255,.06);
      outline:none; transition:border .2s ease, box-shadow .2s ease;
    }
    .input::placeholder{ color:#b8c7da }
    .input:focus{
      border-color: rgba(56,189,248,.7);
      box-shadow: 0 0 0 4px rgba(56,189,248,.15);
    }

    .cta{
      position:relative;
      font-weight:800; font-size:16px; letter-spacing:.2px;
      padding:14px 18px; border-radius:12px; border:0;
      color:#051018; background:linear-gradient(180deg, #7dd3fc, #38bdf8);
      box-shadow: 0 10px 30px rgba(56,189,248,.35), inset 0 -6px 12px rgba(0,0,0,.12);
      cursor:pointer; user-select:none;
      transition: transform .08s ease, box-shadow .2s ease;
      overflow:hidden;
    }
    .cta:hover{ transform: translateY(-1px); }
    .cta:active{ transform: translateY(0); }
    .cta:focus-visible{ outline: var(--outline-focus); outline-offset:3px; }

    /* Micro-glitch on hover using pseudo slices */
    .cta::before, .cta::after{
      content:""; position:absolute; inset:0; pointer-events:none; opacity:0;
      background:linear-gradient(90deg, transparent 0%, rgba(255,255,255,.3) 40%, transparent 60%);
      mix-blend-mode: overlay;
    }
    .cta:hover::before{ animation:gl1 .7s steps(12) infinite; opacity:.8 }
    .cta:hover::after{ animation:gl2 1.1s steps(16) infinite; opacity:.5 }
    @keyframes gl1{
      0%{ clip-path: inset(0 0 80% 0); transform: translate(0,0)}
      50%{ clip-path: inset(60% 0 0 0); transform: translate(-2px,-1px)}
      100%{ clip-path: inset(0 0 80% 0); transform: translate(1px,1px)}
    }
    @keyframes gl2{
      0%{ clip-path: inset(0 0 88% 0); transform: translate(0,0)}
      50%{ clip-path: inset(70% 0 0 0); transform: translate(1px,-1px)}
      100%{ clip-path: inset(0 0 88% 0); transform: translate(-1px,1px)}
    }

    .note{ font-size:14px; color:var(--muted); min-height:1.2em; margin-top:6px }
    .ok{ color:#22c55e } .err{ color:#ef4444 }

    footer{
      padding: clamp(10px, 2vw, 18px) clamp(16px, 3vw, 40px);
      color:#87a1bb; font-size:14px;
    }

    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0 }

    @media (prefers-reduced-motion: reduce){
      .shimmer::after{ display:none }
      .dot{ animation:none }
      .cta::before, .cta::after{ animation:none !important }
    }

    /* =========================
       ‚ö° Mobile performance mode
       (iOS n'aime pas grain+blur+FX √† fond)
    ========================== */
    @media (max-width: 768px){
      .grain{ display:none; }                        /* grain co√ªteux */
      .rings svg{ opacity:.45; }                     /* glow r√©duit */
      .card{ backdrop-filter:none; background: rgba(255,255,255,.04); } /* blur off */
      .shimmer::after{ display:none; }               /* shimmer off */
    }

    /* ‚ö° Quand on tape dans l'input : coupe tous les FX pour une saisie ultra fluide */
    .noFX .grain,
    .noFX #fx,
    .noFX .rings { display:none !important; }
  </style>
</head>
<body>
  <!-- STATIC BACKDROPS -->
  <div class="gradient" aria-hidden="true"></div>
  <div class="grain" aria-hidden="true"></div>

  <!-- SVG NEON RINGS (slow rotating) -->
  <div class="rings" aria-hidden="true">
    <svg viewBox="0 0 800 800" role="img" aria-label="Decorative neon rings">
      <defs>
        <filter id="glow">
          <feGaussianBlur stdDeviation="6" result="coloredBlur"/>
          <feMerge>
            <feMergeNode in="coloredBlur"/>
            <feMergeNode in="SourceGraphic"/>
          </feMerge>
        </filter>
        <linearGradient id="cy" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="#38bdf8"/>
          <stop offset="100%" stop-color="#60a5fa"/>
        </linearGradient>
      </defs>

      <!-- outer ring -->
      <g filter="url(#glow)" opacity="0.55">
        <circle cx="400" cy="400" r="280" fill="none" stroke="url(#cy)" stroke-width="2"/>
        <circle cx="400" cy="400" r="280" fill="none" stroke="url(#cy)" stroke-width="18" stroke-opacity=".12"/>
        <animateTransform attributeName="transform" type="rotate" from="0 400 400" to="360 400 400" dur="40s" repeatCount="indefinite"/>
      </g>

      <!-- inner ring -->
      <g filter="url(#glow)" opacity="0.75">
        <ellipse cx="400" cy="400" rx="170" ry="220" fill="none" stroke="url(#cy)" stroke-width="2"/>
        <ellipse cx="400" cy="400" rx="170" ry="220" fill="none" stroke="url(#cy)" stroke-width="12" stroke-opacity=".12"/>
        <animateTransform attributeName="transform" type="rotate" from="0 400 400" to="-360 400 400" dur="55s" repeatCount="indefinite"/>
      </g>
    </svg>
  </div>

  <!-- CANVAS PARTICLES -->
  <canvas id="fx" aria-hidden="true"></canvas>

  <div class="page">
    <header>
      <div class="brand">
        <img src="logo.png" alt="TrendLoom logo" height="32" width="32" />
        <strong class="brand-name">TrendLoom</strong>
      </div>
    </header>

    <main class="hero" role="main">
      <section class="card" aria-label="Waitlist signup">
        <div class="badge"><span class="dot" aria-hidden="true"></span> Launching soon ‚Äî join the private beta</div>

        <h1>
          Create. Post.
          <span class="shimmer">Be Viral.</span>
        </h1>

        <p class="lead">
          The studio that turns your ideas into scroll-stopping content. Join the private beta.
        </p>

        <form class="waitlist" id="waitlist" novalidate>
          <label for="email" class="sr-only">Email address</label>
          <input id="email" class="input" type="email" inputmode="email" autocomplete="email" placeholder="you@email.com" required aria-required="true" />
          <button class="cta" type="submit" aria-label="Join the waitlist">Join the waitlist</button>
          <div id="status" class="note" role="status" aria-live="polite"></div>
        </form>
      </section>
    </main>

    <footer>
      ¬© <span id="y"></span> TrendLoom ‚Äî All rights reserved.
    </footer>
  </div>

  <script>
  /* =========================================================
     UTIL: clamp, lerp
  ========================================================== */
  const clamp = (v, min, max) => Math.max(min, Math.min(max, v));
  const lerp  = (a, b, t) => a + (b - a) * t;

  /* =========================================================
     YEAR
  ========================================================== */
  document.getElementById('y').textContent = new Date().getFullYear();

  /* =========================================================
     SUPABASE: public client (Anon, INSERT only via RLS)
  ========================================================== */
  let sb = null;
  const SUPABASE_URL = "https://vhlaxjjladohftdkancm.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZobGF4ampsYWRvaGZ0ZGthbmNtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA1MzExNzQsImV4cCI6MjA3NjEwNzE3NH0.cBM0hSjAYKgcQk04n8yf_4YReJzqiWoDG8l8oYF_IIQ";

  // Wait for DOM ready so the deferred CDN script has executed
  window.addEventListener('DOMContentLoaded', () => {
    if (window.supabase) {
      sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    }
  });

  /* =========================================================
     FORM: email validation + Supabase INSERT
     + pause FX when typing on mobile (iOS perf)
  ========================================================== */
  (function formLogic(){
    const form   = document.getElementById('waitlist');
    const email  = document.getElementById('email');
    const status = document.getElementById('status');

    const emailRx = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

    function setStatus(msg, ok=false){
      status.textContent = msg;
      status.className = 'note ' + (ok ? 'ok' : (msg ? 'err' : ''));
    }

    // Pause all FX while the keyboard is open (focus)
    email.addEventListener('focus', () => {
      document.documentElement.classList.add('noFX');
    });
    email.addEventListener('blur', () => {
      document.documentElement.classList.remove('noFX');
    });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      setStatus('');

      const value = email.value.trim();
      if(!emailRx.test(value)){
        setStatus('Invalid email.');
        email.focus();
        return;
      }

      // If Supabase client is available, insert into public.waitlist
      if (sb) {
        try {
          const { error } = await sb.from('waitlist').insert([{
            email: value,
            source: 'landing',
            referer: document.referrer || null,
            user_agent: navigator.userAgent || null
          }]);

          if (error) {
            const dup = (error.code === '23505') ||
                        String(error.message||'').toLowerCase().includes('duplicate');
            setStatus(dup ? "That email is already on the list." : "Signup failed ‚Äî please try again.");
            return;
          }

          setStatus("Thanks! You‚Äôre on the list üëã", true);
          email.value = '';
        } catch (err) {
          console.error(err);
          setStatus("Signup failed ‚Äî please try again.");
        }
      } else {
        // Fallback (CDN failed): optimistic success UI
        setStatus("Thanks! You‚Äôre on the list üëã", true);
        email.value = '';
      }
    });

    email.addEventListener('input', () => {
      if(status.textContent) setStatus('');
    });
  })();

  /* =========================================================
     CANVAS PARTICLES (low-cost, parallax-reactive)
     ‚Äî mobile-optimized (fewer nodes, 30fps, no gyro)
  ========================================================== */
  (function particles(){
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if(prefersReduced) return; // respect user's motion preference

    const IS_MOBILE = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent) ||
                      window.matchMedia('(max-width: 768px)').matches;

    const canvas = document.getElementById('fx');
    const ctx = canvas.getContext('2d', { alpha:true });

    const DPR = IS_MOBILE ? 1 : Math.min(2, window.devicePixelRatio || 1);
    let W=0, H=0, cx=0, cy=0;

    const NODES = IS_MOBILE ? 55 : 110;         // fewer on mobile
    const MAX_LINK_DIST = IS_MOBILE ? 110 : 150;

    const nodes = [];
    let pointer = { x: 0, y: 0, tx: 0, ty: 0 };

    // Resize
    const resize = () => {
      W = canvas.clientWidth = window.innerWidth;
      H = canvas.clientHeight = window.innerHeight;
      canvas.width  = Math.floor(W * DPR);
      canvas.height = Math.floor(H * DPR);
      ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
      cx = W/2; cy = H/2;
    };
    resize();
    const ro = new ResizeObserver(resize); ro.observe(document.body);

    // Init nodes
    for(let i=0;i<NODES;i++){
      nodes.push({
        x: Math.random()*W, y: Math.random()*H,
        vx: (Math.random()-.5)*0.4,
        vy: (Math.random()-.5)*0.4,
        r: Math.random()*1.6 + .4
      });
    }

    // Pointer parallax (mouse/touch). No gyro on mobile (costly on iOS)
    let lastMove = 0;
    window.addEventListener('pointermove', (e)=>{
      const now = performance.now();
      if(now - lastMove < 12) return; // throttle
      lastMove = now;
      pointer.tx = e.clientX;
      pointer.ty = e.clientY;
    }, { passive:true });

    // Animation loop (30fps on mobile, 60 on desktop)
    let lastT = 0;
    function tick(t){
      // If user is typing, skip all drawing for buttery input
      if (document.documentElement.classList.contains('noFX')) {
        raf = requestAnimationFrame(tick);
        return;
      }
      if (IS_MOBILE && t - lastT < 33) { // ~30fps
        raf = requestAnimationFrame(tick);
        return;
      }
      lastT = t;

      pointer.x = lerp(pointer.x || cx, pointer.tx || cx, 0.06);
      pointer.y = lerp(pointer.y || cy, pointer.ty || cy, 0.06);

      ctx.clearRect(0,0,W,H);

      // move & draw nodes
      ctx.fillStyle = 'rgba(185, 223, 255, .8)';
      for(const n of nodes){
        n.x += n.vx; n.y += n.vy;

        // gentle pull to center + slight pointer orbit
        const dx = (pointer.x - n.x) * 0.0009;
        const dy = (pointer.y - n.y) * 0.0009;
        n.vx += dx; n.vy += dy;

        // wrap bounds
        if(n.x < -50) n.x = W+50; if(n.x > W+50) n.x = -50;
        if(n.y < -50) n.y = H+50; if(n.y > H+50) n.y = -50;

        ctx.beginPath();
        ctx.arc(n.x, n.y, n.r, 0, Math.PI*2);
        ctx.fill();
      }

      // links
      ctx.lineWidth = 1;
      for(let i=0;i<nodes.length;i++){
        for(let j=i+1;j<nodes.length;j++){
          const a = nodes[i], b = nodes[j];
          const dx = a.x-b.x, dy = a.y-b.y;
          const d = Math.hypot(dx,dy);
          if(d < MAX_LINK_DIST){
            const alpha = (1 - d / MAX_LINK_DIST) * .25;
            ctx.strokeStyle = `rgba(86, 196, 255, ${alpha.toFixed(3)})`;
            ctx.beginPath(); ctx.moveTo(a.x, a.y); ctx.lineTo(b.x, b.y); ctx.stroke();
          }
        }
      }

      raf = requestAnimationFrame(tick);
    }
    let raf = requestAnimationFrame(tick);
  })();

  /* =========================================================
     PREVENT DESKTOP SCROLL WHEEL from moving page (UX)
  ========================================================== */
  (function noWheelDesktop(){
    const desktop = () => window.innerWidth >= 1025;
    function onWheel(e){ if(desktop()) e.preventDefault(); }
    window.addEventListener('wheel', onWheel, { passive:false });
  })();
  </script>
</body>
</html>

